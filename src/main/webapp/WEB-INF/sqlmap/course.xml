<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap
PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
"http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="course">
	<!--别名区 -->
	<typeAlias alias="CourseDO" type="com.egghead.nicefood.dal.CourseDO" />
	<resultMap id="MiniCourseMap" class="CourseDO">
		<result property="coid" column="gid" />
		<result property="name" column="name" />
		<result property="picsJson" column="pics" />
		<result property="description" column="description" />
	</resultMap>
	<!--resultMap 区 -->
	<resultMap id="CourseMap" class="CourseDO">
		<result property="coid" column="gid" />
		<result property="name" column="name" />
		<result property="picsJson" column="pics" />
		<result property="description" column="description" />
		<result property="materialsJson" column="materials" />
		<result property="stepsJson" column="steps" />
		<result property="tagsJson" column="tags" />
		<result property="sourceUrl" column="source_url"/>
		<result property="gmtCreate" column="gmt_create"/>
		<result property="gmtModified" column="gmt_modified"/>
	</resultMap>
	<select id="Course.get" resultMap="CourseDO">
		SELECT * FROM course where coid = #coid#
	</select>
	<select id="Course.getMiniCourseByName" resultMap="CourseDO">
		SELECT coid,name,picsJson,description FROM course where name = #name# limit #limit#;  
	</select>
	<insert id="Course.insert" parameterClass="CourseDO">
		insert into course(name,pics,material,step,description,tags,source_url,gmt_create,gmt_modified)
		values (#name#,#pics#,#material#,#step#,#description#,#tags#,#sourceUrl#,#now#,#now#)
		<selectKey resultClass="Long" keyProperty="coid">
			SELECT @@IDENTITY AS ID
        </selectKey>
	</insert>
</sqlMap>